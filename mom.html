<!doctype html>
<html lang="en">
	<head>
    <!-- Required meta tags -->
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous"/>
		<script src="https://code.jquery.com/jquery-3.4.0.min.js" integrity="sha256-BJeo0qm959uMBGb65z40ejJYGSgR7REI4+CW1fNKwOg=" crossorigin="anonymous"></script>
		<style>
			body{
				margin:10px;
				font-size: 1.5em;
			}

			ul>li{
				margin-top:20px;	

			}

			ul{
				position: absolute;
				left: -33px;
			}

			.categoriesDiv{
				position:fixed;
				right:10px;
				top:200px;
				background: rgba(204, 218, 245, 0.6);
				font-size:20px;
				width:20vw;
				height: 50vh;
			}
		</style>
		
		<script>
			var data = JSON.parse('{"items": [{"id": 1,"name": "蒜粗","unit": "包"}, {"id": 2,"name": "蒜泥","unit": "包"}, {"id": 3,"name": "蔥","unit": "把"}, {"id": 4,"name": "薑絲","unit": "包"}, {"id": 5,"name": "老薑","unit": "斤"}, {"id": 6,"name": "芹菜","unit": "把"}, {"id": 7,"name": "紅辣椒(大)","unit": "斤"}, {"id": 8,"name": "糯米椒","unit": "斤"}, {"id": 9,"name": "青椒","unit": "斤"}, {"id": 10,"name": "茄子","unit": "件"}, {"id": 11,"name": "韭菜花","unit": "把"}, {"id": 12,"name": "空心菜","unit": "斤"},{"id": 14,"name": "大白菜","unit": "件"}, {"id": 16,"name": "袖珍菇","unit": "包"}, {"id": 17,"name": "金針菇","unit": "斤"}, {"id": 18,"name": "杏包菇","unit": "包"}, {"id": 20,"name": "貢丸","unit": "包"}, {"id": 21,"name": "豆干","unit": "斤"}, {"id": 22,"name": "麵腸","unit": "斤"}, {"id": 23,"name": "海帶","unit": "斤"}, {"id": 24,"name": "小芥菜","unit": "斤"}, {"id": 25,"name": "豬血","unit": "包"}, {"id": 26,"name": "地瓜葉","unit": "件"}, {"id": 27,"name": "香菜","unit": "斤"}, {"id": 28,"name": "高麗菜","unit": "件"}, {"id": 29,"name": "菠菜","unit": "斤"}, {"id": 30,"name": "豆芽菜","unit": "斤"}, {"id": 31,"name": "長豆","unit": "把"}, {"id": 32,"name": "小黃瓜","unit": "斤"}, {"id": 33,"name": "甜豆","unit": "斤"}, {"id": 34,"name": "絲瓜","unit": "件"}, {"id": 35,"name": "苦瓜","unit": "件"}, {"id": 36,"name": "胡瓜","unit": "件"}, {"id": 37,"name": "蕃茄","unit": "件"}, {"id": 38,"name": "莧菜","unit": "斤"}, {"id": 39,"name": "蚵白","unit": "斤"}, {"id": 40,"name": "吉古拉","unit": "包"}, {"id": 41,"name": "菜頭","unit": "斤"}, {"id": 43,"name": "板豆腐","unit": "片"}, {"id": 44,"name": "油豆腐皮","unit": "斤"}, {"id": 45,"name": "油菜","unit": "斤"}, {"id": 46,"name": "青江菜","unit": "斤"}, {"id": 47,"name": "西洋芹","unit": "顆"}, {"id": 48,"name": "煙燻豆皮","unit": "斤"}, {"id": 49,"name": "紅菜頭","unit": "件"}, {"id": 50,"name": "韮菜","unit": "把"}, {"id": 51,"name": "干𢇁","unit": "包"}, {"id": 52,"name": "麻竹筍","unit": "件"}, {"id": 53,"name": "大黃瓜","unit": "斤"}, {"id": 54,"name": "四季豆","unit": "斤"}, {"id": 55,"name": "紅蔥頭(絞碎)","unit": "斤"}, {"id": 56,"name": "豆干絲","unit": "包"}, {"id": 57,"name": "豆芽菜","unit": "斤"}, {"id": 58,"name": "甜不辣","unit": "斤"}, {"id": 59,"name": "海帶𢇁","unit": "斤"}, {"id": 60,"name": "洋蔥","unit": "件"}, {"id": 61,"name": "脆瓜","unit": "包"}, {"id": 62,"name": "馬鈴薯","unit": "斤"}, {"id": 63,"name": "玉米粒","unit": "包"}]}');
			var catogeries = JSON.parse('{"catogeries":[{"id":1,"name":"葉菜類","items":[6,12,14,24,26,28,29,38,39,45,46,47,50]},{"id":2,"name":"蔬菜類","items":[8,9,10,11,37,41,49,52,62,63]},{"id":3,"name":"瓜類","items":[32,34,35,36,53,61]},{"id":4,"name":"菇類","items":[16,17,18]},{"id":5,"name":"豆類","items":[31,33,54,57]},{"id":6,"name":"香料","items":[1,2,3,4,5,7,27,55,60]},{"id":7,"name":"其他","items":[20,21,22,23,25,40,43,44,48,56,58,59]}]}');
			
			function init(){
				createRowOfTable();
			}
			
			function createInput(obj){
				return "<div class='form-group row'><div class='col-sm-12'><input type='number' class='form-control formInputs' id='"+obj.id+"' placeholder='數量'><input type='hidden' value='"+obj.name+"' id='name"+obj.id+"'><input type='hidden' value='"+obj.unit+"' id='unit"+obj.id+"'> </div></div>";
			}
			
			function createRowOfTable(){
				$.each(	catogeries.catogeries , function(ix,im){
					$("#tbody").append("<tr> <td colspan='3' align='center' id='cid"+im.id+"'><b>"+im.name+"</b></td> </tr>");
					var items =  $.grep(data.items,function(e,i){
						return $.inArray(e.id,im.items)>=0;
					});
					$.each(	items , function(index,item){
						$("#tbody").append("<tr> <td>"+item.name+"</td> <td>"+createInput(item)+"</td> <td>"+item.unit+"</td> </tr>");
					});
				});
			}
			$(document).ready(function(){
				init();
				
				$("#doCopy").on('click',function(){
					$("#copyInput").val("本次訂購如下:%0D%0A");
					$(".formInputs").each(function() {
					  var message = $("#copyInput").val();
					  var id = $( this ).attr( "id" );
					  var number = $( this ).val();
					  if(number === undefined || number == 0) return;
					  var name = $( "#name"+id ).val();
					  var unit = $( "#unit"+id ).val();
					  message = message + name + "：" + number + " "+unit +"%0D%0A";
					  $("#copyInput").val(message);
					});
					
					var url = "https://line.me/R/msg/text/?"+$("#copyInput").val();
					$(".formInputs").val("");
					window.open(url,'_blank');
				});

				$(".category").on('click',function(){
					$('html,body').animate({

						scrollTop:$("#cid"+$(this).attr("data-id")).offset().top

					}, "show");

					return false;
				});
			});
			
		</script>
		
		
	</head>
	
	<body class="bg-light">
		<div class="container">
			<div class="row">
				<div class="col-md-12">
					<form>
						<table class="table"> 
							<thead class="thead-dark">
								<tr>
									<th scope="col" style="width: 30%">品名</th>
									<th scope="col" style="width: 40%">數量</th>
									<th scope="col" style="width: 30%">單位</th>
								</tr>
							</thead>
							<tbody id="tbody">
								
							</tbody>
						</table>
						<input type="hidden" id="copyInput">
					</form>
				</div>
			</div>
			<div class="row">
				<div class="col-md-12">
					<form method="get" action="" id="sendLineForm">
					
						
					</form>
					<button type="button" class="btn btn-success btn-lg " id="doCopy">傳送到LINE</button>
					<div id="cid8"></div>
				</div>
			</div>
			<div style="" class="categoriesDiv">
				<ul style="list-style-type: none;">
					<li> <a href="#" class="category" data-id="1">葉菜類</a> </li>
					<li><a href="#" class="category" data-id="2">蔬菜類</a></li>
					<li><a href="#" class="category" data-id="3">瓜類</a></li>
					<li><a href="#" class="category" data-id="4">菇類</a></li>
					<li><a href="#" class="category" data-id="5">豆類</a></li>
					<li><a href="#" class="category" data-id="6">香料</a></li>
					<li><a href="#" class="category" data-id="7">其他</a></li>
					<li><a href="#" class="category" data-id="8">傳送鈕</a></li>
				</ul>
			</div>
		</div>
	</body>
</html>